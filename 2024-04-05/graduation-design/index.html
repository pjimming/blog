<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>【毕业季】本科毕设《Magic Camera》需求清单 - 江明说|Jimmy Talk</title><meta http-equiv=x-dns-prefetch-control content="on">
<link rel=dns-prefetch href=//cdn.jsdelivr.net><link rel=dns-prefetch href=//pjimming.github.io><meta name=Description content="江明说"><meta property="og:url" content="https://blog.pjmcode.top/2024-04-05/graduation-design/"><meta property="og:site_name" content="江明说|Jimmy Talk"><meta property="og:title" content="【毕业季】本科毕设《Magic Camera》需求清单"><meta property="og:description" content="记录本科毕设的需求、进度"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-05T11:04:16+08:00"><meta property="article:modified_time" content="2025-01-26T20:30:29+08:00"><meta property="article:tag" content="Blog"><meta property="article:tag" content="毕业设计"><meta property="og:image" content="https://blog.pjmcode.top/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.pjmcode.top/logo.png"><meta name=twitter:title content="【毕业季】本科毕设《Magic Camera》需求清单"><meta name=twitter:description content="记录本科毕设的需求、进度"><meta name=application-name content="江明说"><meta name=apple-mobile-web-app-title content="江明说"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/images/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.pjmcode.top/2024-04-05/graduation-design/><link rel=prev href=https://blog.pjmcode.top/2024-04-01/qiniu/><link rel=next href=https://blog.pjmcode.top/2024-05-04/mysql45-1/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"【毕业季】本科毕设《Magic Camera》需求清单","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.pjmcode.top\/2024-04-05\/graduation-design\/"},"genre":"posts","keywords":"blog, 毕业设计","wordcount":7974,"url":"https:\/\/blog.pjmcode.top\/2024-04-05\/graduation-design\/","datePublished":"2024-04-05T11:04:16+08:00","dateModified":"2025-01-26T20:30:29+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"PanJM"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="江明说|Jimmy Talk"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/favicon.ico data-srcset="/images/favicon.ico, /images/favicon.ico 1.5x, /images/favicon.ico 2x" data-sizes=auto alt=/images/favicon.ico title=/images/favicon.ico>Jimmy Talk</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/><i class='fa-solid fa-box-archive'></i> 所有文章 </a><a class=menu-item href=/tags/><i class='fa-solid fa-tag'></i> 标签 </a><a class=menu-item href=/categories/><i class='fa-solid fa-table-list'></i> 分类 </a><a class=menu-item href=/friend/><i class='fa-solid fa-user-group'></i> 友链 </a><a class=menu-item href=/book-list/><i class='fa-solid fa-book'></i> 书单 </a><a class=menu-item href=/about/><i class='fa-regular fa-address-card'></i> 关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="江明说|Jimmy Talk"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/favicon.ico data-srcset="/images/favicon.ico, /images/favicon.ico 1.5x, /images/favicon.ico 2x" data-sizes=auto alt=/images/favicon.ico title=/images/favicon.ico>Jimmy Talk</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title><i class='fa-solid fa-box-archive'></i>所有文章</a><a class=menu-item href=/tags/ title><i class='fa-solid fa-tag'></i>标签</a><a class=menu-item href=/categories/ title><i class='fa-solid fa-table-list'></i>分类</a><a class=menu-item href=/friend/ title><i class='fa-solid fa-user-group'></i>友链</a><a class=menu-item href=/book-list/ title><i class='fa-solid fa-book'></i>书单</a><a class=menu-item href=/about/ title><i class='fa-regular fa-address-card'></i>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">【毕业季】本科毕设《Magic Camera》需求清单</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/pjimming/ title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>PanJM</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/blog/><i class="far fa-folder fa-fw" aria-hidden=true></i>Blog</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-04-05>2024-04-05</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 7974 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 16 分钟&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=https://picx-img.pjmcode.top/20240405/image-image.1lbllk4u06.webp data-srcset="https://picx-img.pjmcode.top/20240405/image-image.1lbllk4u06.webp, https://picx-img.pjmcode.top/20240405/image-image.1lbllk4u06.webp 1.5x, https://picx-img.pjmcode.top/20240405/image-image.1lbllk4u06.webp 2x" data-sizes=auto alt=https://picx-img.pjmcode.top/20240405/image-image.1lbllk4u06.webp title=https://picx-img.pjmcode.top/20240405/image-image.1lbllk4u06.webp></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#数据库设计>数据库设计</a><ul><li><a href=#权限模块>权限模块</a><ul><li><a href=#用户表>用户表</a></li><li><a href=#资源表>资源表</a></li><li><a href=#角色-资源关联表>角色-资源关联表</a></li><li><a href=#角色表>角色表</a></li></ul></li><li><a href=#业务模块>业务模块</a><ul><li><a href=#造型选项表>造型选项表</a></li></ul></li><li><a href=#系统模块>系统模块</a><ul><li><a href=#系统参数表>系统参数表</a></li></ul></li><li><a href=#日志模块>日志模块</a></li><li><a href=#数据初始化>数据初始化</a></li></ul></li><li><a href=#ai-模型需求>AI 模型需求</a><ul><li><a href=#photomaker>PhotoMaker</a></li><li><a href=#ai-部署>AI 部署</a></li></ul></li><li><a href=#接口列表>接口列表</a><ul><li><a href=#1-分页查询-api-日志>1. &ldquo;分页查询 API 日志&rdquo;</a></li><li><a href=#2-用户登录>2. &ldquo;用户登录&rdquo;</a></li><li><a href=#3-用户注册>3. &ldquo;用户注册&rdquo;</a></li><li><a href=#4-用户登出>4. &ldquo;用户登出&rdquo;</a></li><li><a href=#5-获取四位验证码>5. &ldquo;获取四位验证码&rdquo;</a></li><li><a href=#6-获取-tmp-目录下文件>6. &ldquo;获取 tmp 目录下文件&rdquo;</a></li><li><a href=#7-探活-ping>7. &ldquo;探活 ping&rdquo;</a></li><li><a href=#8-生成照片>8. &ldquo;生成照片&rdquo;</a></li><li><a href=#9-获取角色权限树>9. &ldquo;获取角色权限树&rdquo;</a></li><li><a href=#10-分页查询-prompt-option>10. &ldquo;分页查询 Prompt Option&rdquo;</a></li><li><a href=#11-新增-prompt-option>11. &ldquo;新增 Prompt Option&rdquo;</a></li><li><a href=#12-修改-prompt-option>12. &ldquo;修改 Prompt Option&rdquo;</a></li><li><a href=#13-删除-prompt-option>13. &ldquo;删除 Prompt Option&rdquo;</a></li><li><a href=#14-获取全部-prompt-option>14. &ldquo;获取全部 Prompt Option&rdquo;</a></li><li><a href=#15-新增资源>15. &ldquo;新增资源&rdquo;</a></li><li><a href=#16-修改资源>16. &ldquo;修改资源&rdquo;</a></li><li><a href=#17-删除资源>17. &ldquo;删除资源&rdquo;</a></li><li><a href=#18-获取菜单资源树>18. &ldquo;获取菜单资源树&rdquo;</a></li><li><a href=#19-给用户分配角色>19. &ldquo;给用户分配角色&rdquo;</a></li><li><a href=#20-新增角色>20. &ldquo;新增角色&rdquo;</a></li><li><a href=#21-更新角色>21. &ldquo;更新角色&rdquo;</a></li><li><a href=#22-删除角色>22. &ldquo;删除角色&rdquo;</a></li><li><a href=#23-查询角色>23. &ldquo;查询角色&rdquo;</a></li><li><a href=#24-分页查询角色>24. &ldquo;分页查询角色&rdquo;</a></li><li><a href=#25-分页查询系统参数>25. &ldquo;分页查询系统参数&rdquo;</a></li><li><a href=#26-新增系统参数>26. &ldquo;新增系统参数&rdquo;</a></li><li><a href=#27-修改系统参数>27. &ldquo;修改系统参数&rdquo;</a></li><li><a href=#28-删除系统参数>28. &ldquo;删除系统参数&rdquo;</a></li><li><a href=#29-获取单个系统参数>29. &ldquo;获取单个系统参数&rdquo;</a></li><li><a href=#30-分页查询用户>30. &ldquo;分页查询用户&rdquo;</a></li><li><a href=#31-更新角色>31. &ldquo;更新角色&rdquo;</a></li><li><a href=#32-获取全部角色>32. &ldquo;获取全部角色&rdquo;</a></li><li><a href=#33-获取用户详情>33. &ldquo;获取用户详情&rdquo;</a></li><li><a href=#34-用户修改密码>34. &ldquo;用户修改密码&rdquo;</a></li><li><a href=#35-重置密码>35. &ldquo;重置密码&rdquo;</a></li></ul></li><li><a href=#运维需求>运维需求</a><ul><li><a href=#mysql-服务部署>MySQL 服务部署</a></li><li><a href=#redis-服务部署>Redis 服务部署</a></li><li><a href=#nginx-服务部署>Nginx 服务部署</a></li><li><a href=#docker-compose>Docker Compose</a></li><li><a href=#前端部署>前端部署</a></li><li><a href=#后端部署>后端部署</a></li><li><a href=#prometheus-部署>Prometheus 部署</a></li><li><a href=#部署-node-exporter>部署 Node Exporter</a></li><li><a href=#部署-mysqld-exporter>部署 MySQLd Exporter</a></li><li><a href=#部署-redis-exporter>部署 Redis Exporter</a></li><li><a href=#部署-grafana>部署 Grafana</a></li></ul></li><li><a href=#遇到的问题>遇到的问题</a><ul><li><a href=#图片上传前后端交互>图片上传前后端交互</a><ul><li><a href=#前端代码>前端代码</a></li><li><a href=#后端代码>后端代码</a></li></ul></li><li><a href=#数据库软删除与唯一索引冲突>数据库软删除与唯一索引冲突</a></li><li><a href=#前端-json-展示>前端 json 展示</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>记录本科毕设的需求、进度</p><hr><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>目前进度<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>数据库</p><ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 数据库设计<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> prompt_option: prompt 选项表</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> resource: 资源表</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> role: 角色表</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> role_resource_rel: 角色-资源关联表</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> sys_param: 系统参数表</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> user_basic: 用户表</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> api_log: API 日志表</li></ul></li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 资源初始化</li></ul><p>后端服务</p><ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> API<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 登录/注册/登出</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> PhotoMaker</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 权限模块<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 角色管理：增删改查</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 用户管理：增删改查</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 资源树管理：增删改查</li></ul></li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Prompt 管理：增删改查</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 系统参数管理：增删改查</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> API 日志模块：增查</li></ul></li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 中间件<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> JWT 认证</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 业务限流器<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 缓存限流次数</li></ul></li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> API 日志记录<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 字段脱敏</li></ul></li></ul></li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 优化<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 对 DB 封装一层 Redis 缓存</li></ul></li></ul><p>前端页面</p><ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 身份认证功能：登录/注册/登出</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 首页业务页面：魔力照相机</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 系统管理页面<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 角色管理页面</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 资源管理页面</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 用户管理页面</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Prompt 管理页面</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 系统参数管理页面</li></ul></li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 监控视图页面<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 服务器监控面板</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Go 进程监控面板</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Redis 监控面板</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> MySQL 监控面板</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> WEB API 监控面板</li></ul></li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> API 日志查询页面</li></ul><p>测试</p><ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 登录/注册/登出</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 业务模块</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 后台管理模块<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 权限模块</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 用户模块</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 角色模块</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Prompt 模块</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 系统参数模块</li></ul></li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 监控模块<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 服务器监控面板</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Go 进程监控面板</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Redis 监控面板</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> MySQL 监控面板</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> WEB API 监控面板</li></ul></li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 日志模块</li></ul><p>运维相关</p><ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 流水线发布（前端）</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 流水线发布（后端）</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Nginx 部署</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> MySQL 部署</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Redis 部署</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 监控组件部署<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Prometheus 部署</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> node_exporter 部署</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> mysqld_exporter 部署</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> redis_exporter 部署</li></ul></li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Grafana 部署<ul><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 服务器 Dashboard</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Go 进程 Dashboard</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> Redis Dashboard</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> MySQL Dashboard</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> WEB API Dashboard</li></ul></li><li><i class="far fa-square fa-fw" aria-hidden=true></i> SSL/TLS 证书</li><li><i class="far fa-check-square fa-fw" aria-hidden=true></i> 日志</li><li><i class="far fa-square fa-fw" aria-hidden=true></i> Prompt 设置</li></ul></div></div></div><h2 id=数据库设计>数据库设计</h2><p>单体服务，采用 mysql 作为底层数据库，使用 redis 做缓存数据库。</p><h3 id=权限模块>权限模块</h3><p>通过 RBAC 模型的方式，基于角色控制资源权限，表字段设计如下：</p><h4 id=用户表>用户表</h4><table><thead><tr><th style=text-align:left>字段名</th><th style=text-align:left>类型</th><th style=text-align:left>NULL</th><th style=text-align:left>Key</th><th style=text-align:left>Default</th><th style=text-align:left>Extra</th></tr></thead><tbody><tr><td style=text-align:left>id</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>NO</td><td style=text-align:left>PRI</td><td style=text-align:left>null</td><td style=text-align:left>auto_increment</td></tr><tr><td style=text-align:left>created_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>updated_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>deleted_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>username</td><td style=text-align:left>varchar(50)</td><td style=text-align:left>NO</td><td style=text-align:left>UNI</td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>password_hash</td><td style=text-align:left>varchar(255)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>role_id</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>NO</td><td style=text-align:left>MUL</td><td style=text-align:left>0</td><td style=text-align:left></td></tr><tr><td style=text-align:left>last_login</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>is_enable</td><td style=text-align:left>tinyint(1)</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>biz_count</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>0</td><td style=text-align:left></td></tr></tbody></table><p>建表语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>user_basic</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;序号&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>created_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;创建时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>updated_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;更新时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>deleted_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;删除时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>username</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;用户名&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>password_hash</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;加密过后的密码&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>role_id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;0&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;所属角色&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>last_login</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;最后登录时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>is_enable</span><span class=o>`</span><span class=w> </span><span class=n>tinyint</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;是否启用:1-启用;0-禁用&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>biz_count</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;0&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;使用业务接口次数&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>username</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>username</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>fk_user_role</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>role_id</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=o>`</span><span class=n>fk_user_role</span><span class=o>`</span><span class=w> </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>role_id</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=o>`</span><span class=k>role</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=o>=</span><span class=mi>16</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8mb3</span><span class=w> </span><span class=k>COMMENT</span><span class=o>=</span><span class=s1>&#39;用户表&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=资源表>资源表</h4><table><thead><tr><th style=text-align:left>字段名</th><th style=text-align:left>类型</th><th style=text-align:left>Null</th><th style=text-align:left>Key</th><th style=text-align:left>Default</th><th style=text-align:left>Extra</th></tr></thead><tbody><tr><td style=text-align:left>id</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>NO</td><td style=text-align:left>PRI</td><td style=text-align:left>null</td><td style=text-align:left>auto_increment</td></tr><tr><td style=text-align:left>created_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>updated_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>deleted_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>name</td><td style=text-align:left>varchar(255)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>code</td><td style=text-align:left>varchar(255)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>type</td><td style=text-align:left>varchar(255)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>parent_id</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>0</td><td style=text-align:left></td></tr><tr><td style=text-align:left>order</td><td style=text-align:left>int</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>0</td><td style=text-align:left></td></tr><tr><td style=text-align:left>icon</td><td style=text-align:left>varchar(512)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>component</td><td style=text-align:left>varchar(512)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>path</td><td style=text-align:left>varchar(512)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>is_show</td><td style=text-align:left>tinyint(1)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>0</td><td style=text-align:left></td></tr><tr><td style=text-align:left>is_enable</td><td style=text-align:left>tinyint(1)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>0</td><td style=text-align:left></td></tr></tbody></table><p>建表语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>resource</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;序号&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>created_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;创建时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>updated_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;更新时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>deleted_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;删除时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;名称&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>code</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;编码&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=k>type</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;类型&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>parent_id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;0&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;父节点id&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=k>order</span><span class=o>`</span><span class=w> </span><span class=nb>int</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;0&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;排序&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>icon</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>512</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;菜单图标&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>component</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>512</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;组件路径&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>path</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>512</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;路由地址&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>is_show</span><span class=o>`</span><span class=w> </span><span class=n>tinyint</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;0&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;是否显示&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>is_enable</span><span class=o>`</span><span class=w> </span><span class=n>tinyint</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;0&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;是否启用&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=o>=</span><span class=mi>22</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8mb3</span><span class=w> </span><span class=k>COMMENT</span><span class=o>=</span><span class=s1>&#39;资源表&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=角色-资源关联表>角色-资源关联表</h4><table><thead><tr><th style=text-align:left>字段名</th><th style=text-align:left>类型</th><th style=text-align:left>Null</th><th style=text-align:left>Key</th><th style=text-align:left>Default</th><th style=text-align:left>Extra</th></tr></thead><tbody><tr><td style=text-align:left>id</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>NO</td><td style=text-align:left>PRI</td><td style=text-align:left>null</td><td style=text-align:left>auto_increment</td></tr><tr><td style=text-align:left>created_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>updated_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>deleted_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>role_id</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>NO</td><td style=text-align:left>MUL</td><td style=text-align:left>0</td><td style=text-align:left></td></tr><tr><td style=text-align:left>resource_id</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>NO</td><td style=text-align:left>MUL</td><td style=text-align:left>0</td><td style=text-align:left></td></tr></tbody></table><p>建表语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>role_resource_rel</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;序号&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>created_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;创建时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>updated_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;更新时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>deleted_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;删除时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>role_id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;0&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;角色id&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>resource_id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;0&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;资源id&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>fk_role</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>role_id</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>fk_resource</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>resource_id</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=o>`</span><span class=n>fk_resource</span><span class=o>`</span><span class=w> </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>resource_id</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=o>`</span><span class=n>resource</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=o>`</span><span class=n>fk_role</span><span class=o>`</span><span class=w> </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>role_id</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=o>`</span><span class=k>role</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=o>=</span><span class=mi>17</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8mb3</span><span class=w> </span><span class=k>COMMENT</span><span class=o>=</span><span class=s1>&#39;角色-资源表&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=角色表>角色表</h4><table><thead><tr><th style=text-align:left>字段名</th><th style=text-align:left>类型</th><th style=text-align:left>Null</th><th style=text-align:left>Key</th><th style=text-align:left>Default</th><th style=text-align:left>Extra</th></tr></thead><tbody><tr><td style=text-align:left>id</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>NO</td><td style=text-align:left>PRI</td><td style=text-align:left>null</td><td style=text-align:left>auto_increment</td></tr><tr><td style=text-align:left>created_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>updated_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>deleted_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>code</td><td style=text-align:left>varchar(255)</td><td style=text-align:left>NO</td><td style=text-align:left>UNI</td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>name</td><td style=text-align:left>varchar(255)</td><td style=text-align:left>NO</td><td style=text-align:left>UNI</td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>is_enable</td><td style=text-align:left>tinyint(1)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>0</td><td style=text-align:left></td></tr></tbody></table><p>建表语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=k>role</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;序号&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>created_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;创建时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>updated_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;更新时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>deleted_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;删除时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>code</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;角色编码&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;角色名&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>is_enable</span><span class=o>`</span><span class=w> </span><span class=n>tinyint</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;0&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;启用状态:0-禁用;1-启用&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>code</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>code</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=o>=</span><span class=mi>9</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8mb3</span><span class=w> </span><span class=k>COMMENT</span><span class=o>=</span><span class=s1>&#39;角色表&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=业务模块>业务模块</h3><p>需要给用户提供一个下拉选项，并且对应 prompt 中英文。</p><h4 id=造型选项表>造型选项表</h4><table><thead><tr><th style=text-align:center>Field</th><th style=text-align:center>Type</th><th style=text-align:center>Null</th><th style=text-align:center>Key</th><th style=text-align:center>Default</th><th style=text-align:center>Extra</th></tr></thead><tbody><tr><td style=text-align:center>id</td><td style=text-align:center>bigint unsigned</td><td style=text-align:center>NO</td><td style=text-align:center>PRI</td><td style=text-align:center>null</td><td style=text-align:center>auto_increment</td></tr><tr><td style=text-align:center>created_at</td><td style=text-align:center>datetime</td><td style=text-align:center>YES</td><td style=text-align:center></td><td style=text-align:center>null</td><td style=text-align:center></td></tr><tr><td style=text-align:center>updated_at</td><td style=text-align:center>datetime</td><td style=text-align:center>YES</td><td style=text-align:center></td><td style=text-align:center>null</td><td style=text-align:center></td></tr><tr><td style=text-align:center>deleted_at</td><td style=text-align:center>datetime</td><td style=text-align:center>YES</td><td style=text-align:center></td><td style=text-align:center>null</td><td style=text-align:center></td></tr><tr><td style=text-align:center>name</td><td style=text-align:center>varchar(255)</td><td style=text-align:center>NO</td><td style=text-align:center>UNI</td><td style=text-align:center></td><td style=text-align:center></td></tr><tr><td style=text-align:center>prompt</td><td style=text-align:center>text</td><td style=text-align:center>YES</td><td style=text-align:center></td><td style=text-align:center>null</td><td style=text-align:center></td></tr><tr><td style=text-align:center>negative_prompt</td><td style=text-align:center>text</td><td style=text-align:center>YES</td><td style=text-align:center></td><td style=text-align:center>null</td><td style=text-align:center></td></tr><tr><td style=text-align:center>desc</td><td style=text-align:center>varchar(255)</td><td style=text-align:center>NO</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td></tr></tbody></table><p>建表语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>prompt_option</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;序号&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>created_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;创建时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>updated_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;更新时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>deleted_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;删除时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;选项名&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>prompt</span><span class=o>`</span><span class=w> </span><span class=nb>text</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;prompt&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>negative_prompt</span><span class=o>`</span><span class=w> </span><span class=nb>text</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;负面prompt&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=k>desc</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;描述&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=o>=</span><span class=mi>5</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8mb3</span><span class=w> </span><span class=k>COMMENT</span><span class=o>=</span><span class=s1>&#39;prompt选项表&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=系统模块>系统模块</h3><h4 id=系统参数表>系统参数表</h4><table><thead><tr><th style=text-align:center>字段名</th><th style=text-align:center>字段类型</th><th style=text-align:center>Null</th><th style=text-align:center>Key</th><th style=text-align:center>Default</th><th style=text-align:center>Extra</th></tr></thead><tbody><tr><td style=text-align:center>id</td><td style=text-align:center>bigint unsigned</td><td style=text-align:center>NO</td><td style=text-align:center>PRI</td><td style=text-align:center>null</td><td style=text-align:center>auto_increment</td></tr><tr><td style=text-align:center>created_at</td><td style=text-align:center>datetime</td><td style=text-align:center>YES</td><td style=text-align:center></td><td style=text-align:center>null</td><td style=text-align:center></td></tr><tr><td style=text-align:center>updated_at</td><td style=text-align:center>datetime</td><td style=text-align:center>YES</td><td style=text-align:center></td><td style=text-align:center>null</td><td style=text-align:center></td></tr><tr><td style=text-align:center>deleted_at</td><td style=text-align:center>datetime</td><td style=text-align:center>YES</td><td style=text-align:center></td><td style=text-align:center>null</td><td style=text-align:center></td></tr><tr><td style=text-align:center>key</td><td style=text-align:center>varchar(255)</td><td style=text-align:center>NO</td><td style=text-align:center>UNI</td><td style=text-align:center>null</td><td style=text-align:center></td></tr><tr><td style=text-align:center>value</td><td style=text-align:center>text</td><td style=text-align:center>YES</td><td style=text-align:center></td><td style=text-align:center>null</td><td style=text-align:center></td></tr><tr><td style=text-align:center>desc</td><td style=text-align:center>varchar(255)</td><td style=text-align:center>NO</td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td></tr></tbody></table><p>建表语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>sys_param</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;序号&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>created_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;创建时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>updated_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;更新时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>deleted_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;删除时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=k>key</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;键&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>value</span><span class=o>`</span><span class=w> </span><span class=nb>text</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;值&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=k>desc</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;描述&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=k>key</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=k>key</span><span class=o>`</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=o>=</span><span class=mi>13</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8mb3</span><span class=w> </span><span class=k>COMMENT</span><span class=o>=</span><span class=s1>&#39;系统参数表&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=日志模块>日志模块</h3><table><thead><tr><th style=text-align:left>字段名</th><th style=text-align:left>字段类型</th><th style=text-align:left>Null</th><th style=text-align:left>Key</th><th style=text-align:left>Default</th><th style=text-align:left>Extra</th></tr></thead><tbody><tr><td style=text-align:left>id</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>NO</td><td style=text-align:left>PRI</td><td style=text-align:left>null</td><td style=text-align:left>auto_increment</td></tr><tr><td style=text-align:left>created_at</td><td style=text-align:left>datetime</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>method</td><td style=text-align:left>varchar(64)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>api_path</td><td style=text-align:left>text</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>req_header</td><td style=text-align:left>mediumtext</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>req_body</td><td style=text-align:left>mediumtext</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>status</td><td style=text-align:left>varchar(64)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>operator</td><td style=text-align:left>varchar(255)</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>remote_ip</td><td style=text-align:left>varchar(255)</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>remote_city</td><td style=text-align:left>varchar(255)</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>response</td><td style=text-align:left>longtext</td><td style=text-align:left>YES</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr><tr><td style=text-align:left>cost_time</td><td style=text-align:left>bigint unsigned</td><td style=text-align:left>NO</td><td style=text-align:left></td><td style=text-align:left>null</td><td style=text-align:left></td></tr></tbody></table><p>建表语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>api_log</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;序号&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>created_at</span><span class=o>`</span><span class=w> </span><span class=n>datetime</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;创建时间&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=k>method</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;http方法&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>api_path</span><span class=o>`</span><span class=w> </span><span class=nb>text</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;api路径&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>req_header</span><span class=o>`</span><span class=w> </span><span class=n>mediumtext</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;请求头&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>req_body</span><span class=o>`</span><span class=w> </span><span class=n>mediumtext</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;请求body&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>status</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;状态&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=k>operator</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;操作人&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>remote_ip</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;操作ip&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>remote_city</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;操作地点&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>response</span><span class=o>`</span><span class=w> </span><span class=n>longtext</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;返回结果&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>cost_time</span><span class=o>`</span><span class=w> </span><span class=nb>bigint</span><span class=w> </span><span class=n>unsigned</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=s1>&#39;请求耗时，单位：ms&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=o>=</span><span class=mi>85</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8mb3</span><span class=w> </span><span class=k>COMMENT</span><span class=o>=</span><span class=s1>&#39;API日志表&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=数据初始化>数据初始化</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>magic_camera</span><span class=p>.</span><span class=n>resource</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>created_at</span><span class=p>,</span><span class=w> </span><span class=n>updated_at</span><span class=p>,</span><span class=w> </span><span class=n>deleted_at</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>code</span><span class=p>,</span><span class=w> </span><span class=k>type</span><span class=p>,</span><span class=w> </span><span class=n>parent_id</span><span class=p>,</span><span class=w> </span><span class=k>order</span><span class=p>,</span><span class=w> </span><span class=n>icon</span><span class=p>,</span><span class=w> </span><span class=n>component</span><span class=p>,</span><span class=w> </span><span class=n>path</span><span class=p>,</span><span class=w> </span><span class=n>is_show</span><span class=p>,</span><span class=w> </span><span class=n>is_enable</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>values</span><span class=w>  </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:04:23&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:13:28&#39;</span><span class=p>,</span><span class=w> </span><span class=k>null</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;资源管理&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Resource_Mgt&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MENU&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;i-fe:list&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;/src/views/sys/resource/index.vue&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;/pms/resource&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:04:53&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:04:53&#39;</span><span class=p>,</span><span class=w> </span><span class=k>null</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;系统管理&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;SysMgt&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MENU&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;i-fe:grid&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:05:00&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:13:28&#39;</span><span class=p>,</span><span class=w> </span><span class=k>null</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;角色管理&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;RoleMgt&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MENU&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;i-fe:user-check&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;/src/views/sys/role/index.vue&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;/pms/role&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:05:00&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:13:28&#39;</span><span class=p>,</span><span class=w> </span><span class=k>null</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;用户管理&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;UserMgt&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MENU&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;i-fe:user&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;/src/views/sys/user/index.vue&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;/pms/user&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:05:01&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:13:28&#39;</span><span class=p>,</span><span class=w> </span><span class=k>null</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;分配用户&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;RoleUser&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MENU&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;i-fe:user-plus&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;/src/views/sys/role/role-user.vue&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;/pms/role/user/:roleId&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:05:01&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2024-04-06 07:05:01&#39;</span><span class=p>,</span><span class=w> </span><span class=k>null</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;个人资料&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;UserProfile&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MENU&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>99</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;i-fe:user&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;/src/views/profile/index.vue&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;/profile&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=ai-模型需求>AI 模型需求</h2><h3 id=photomaker>PhotoMaker</h3><p>使用 <a href=https://arxiv.org/abs/2312.04461 target=_blank rel="noopener noreffer">PhotoMaker</a> 作为 AI Work，底层用到了 Stable Diffusion 和 LoRA 微调。</p><h3 id=ai-部署>AI 部署</h3><p>模型算法部署在了 <a href=https://replicate.com/ target=_blank rel="noopener noreffer">Replicate</a> 上，通过 http 接口的方式暴露给后端使用。</p><h2 id=接口列表>接口列表</h2><h3 id=1-分页查询-api-日志>1. &ldquo;分页查询 API 日志&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/api-log</li><li>Method: GET</li><li>Request: <code>GetApiLogReq</code></li><li>Response: <code>GetApiLogResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetApiLogReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Page</span> <span class=kt>int</span> <span class=s>`form:&#34;page,default=1&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Size</span> <span class=kt>int</span> <span class=s>`form:&#34;size,default=10&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Method</span> <span class=kt>string</span> <span class=s>`form:&#34;method,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>APIPath</span> <span class=kt>string</span> <span class=s>`form:&#34;apiPath,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Status</span> <span class=kt>string</span> <span class=s>`form:&#34;status,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Operator</span> <span class=kt>string</span> <span class=s>`form:&#34;operator,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>RemoteIP</span> <span class=kt>string</span> <span class=s>`form:&#34;remoteIp,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>RemoteCity</span> <span class=kt>string</span> <span class=s>`form:&#34;remoteCity,optional&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetApiLogResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Items</span> <span class=p>[]</span><span class=o>*</span><span class=nx>ApiLog</span> <span class=s>`json:&#34;items&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Total</span> <span class=kt>int64</span> <span class=s>`json:&#34;total&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-用户登录>2. &ldquo;用户登录&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/user/login</li><li>Method: POST</li><li>Request: <code>UserLoginReq</code></li><li>Response: <code>UserLoginResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>UserLoginReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Username</span> <span class=kt>string</span> <span class=s>`json:&#34;username&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Password</span> <span class=kt>string</span> <span class=s>`json:&#34;password&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Captcha</span> <span class=kt>string</span> <span class=s>`json:&#34;captcha&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>CaptchaId</span> <span class=kt>string</span> <span class=s>`json:&#34;captchaId&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>UserLoginResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Token</span> <span class=kt>string</span> <span class=s>`json:&#34;token&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-用户注册>3. &ldquo;用户注册&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/user/register</li><li>Method: POST</li><li>Request: <code>UserRegisterReq</code></li><li>Response: <code>UserRegisterResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>UserRegisterReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Username</span> <span class=kt>string</span> <span class=s>`json:&#34;username&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Password</span> <span class=kt>string</span> <span class=s>`json:&#34;password&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Captcha</span> <span class=kt>string</span> <span class=s>`json:&#34;captcha&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>CaptchaId</span> <span class=kt>string</span> <span class=s>`json:&#34;captchaId&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>UserRegisterResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Token</span> <span class=kt>string</span> <span class=s>`json:&#34;token&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=4-用户登出>4. &ldquo;用户登出&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/user/logout</li><li>Method: POST</li><li>Request: <code>-</code></li><li>Response: <code>-</code></li></ul><ol start=2><li><p>request definition</p></li><li><p>response definition</p></li></ol><h3 id=5-获取四位验证码>5. &ldquo;获取四位验证码&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/captcha</li><li>Method: GET</li><li>Request: <code>-</code></li><li>Response: <code>GetCaptchaResp</code></li></ul><ol start=2><li><p>request definition</p></li><li><p>response definition</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetCaptchaResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>CaptchaId</span> <span class=kt>string</span> <span class=s>`json:&#34;captcha_id&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>B64s</span> <span class=kt>string</span> <span class=s>`json:&#34;b64s&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=6-获取-tmp-目录下文件>6. &ldquo;获取 tmp 目录下文件&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/file/:dir/:filename</li><li>Method: GET</li><li>Request: <code>GetFileReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetFileReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Dir</span> <span class=kt>string</span> <span class=s>`path:&#34;dir&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Filename</span> <span class=kt>string</span> <span class=s>`path:&#34;filename&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h3 id=7-探活-ping>7. &ldquo;探活 ping&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /ping</li><li>Method: GET</li><li>Request: <code>-</code></li><li>Response: <code>-</code></li></ul><ol start=2><li><p>request definition</p></li><li><p>response definition</p></li></ol><h3 id=8-生成照片>8. &ldquo;生成照片&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/generate/photo</li><li>Method: POST</li><li>Request: <code>GeneratePhotoReq</code></li><li>Response: <code>GeneratePhotoResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GeneratePhotoReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Images</span> <span class=p>[]</span><span class=kt>string</span> <span class=s>`form:&#34;-&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Style</span> <span class=kt>string</span> <span class=s>`form:&#34;style&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Gender</span> <span class=kt>string</span> <span class=s>`form:&#34;gender&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>PromptId</span> <span class=kt>uint64</span> <span class=s>`form:&#34;promptId&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Version</span> <span class=kt>string</span> <span class=s>`form:&#34;version&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GeneratePhotoResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Output</span> <span class=kt>string</span> <span class=s>`json:&#34;output&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Images</span> <span class=p>[]</span><span class=kt>string</span> <span class=s>`json:&#34;images&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Style</span> <span class=kt>string</span> <span class=s>`json:&#34;style&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Gender</span> <span class=kt>string</span> <span class=s>`json:&#34;gender&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>PromptId</span> <span class=kt>uint64</span> <span class=s>`json:&#34;promptId&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Version</span> <span class=kt>string</span> <span class=s>`json:&#34;version&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=9-获取角色权限树>9. &ldquo;获取角色权限树&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/role/permissions/tree</li><li>Method: GET</li><li>Request: <code>-</code></li><li>Response: <code>GetResourceTreeResp</code></li></ul><ol start=2><li><p>request definition</p></li><li><p>response definition</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetResourceTreeResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Resource</span> <span class=p>[]</span><span class=o>*</span><span class=nx>Resource</span> <span class=s>`json:&#34;resource&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=10-分页查询-prompt-option>10. &ldquo;分页查询 Prompt Option&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/prompt-option</li><li>Method: GET</li><li>Request: <code>GetPromptOptionReq</code></li><li>Response: <code>GetPromptOptionResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetPromptOptionReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Page</span> <span class=kt>int</span> <span class=s>`form:&#34;page,default=1&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Size</span> <span class=kt>int</span> <span class=s>`form:&#34;size,default=10&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`form:&#34;name,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Prompt</span> <span class=kt>string</span> <span class=s>`form:&#34;prompt,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>NegativePrompt</span> <span class=kt>string</span> <span class=s>`form:&#34;negativePrompt,optional&#34;`</span> <span class=c1>// 负面prompt
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Desc</span> <span class=kt>string</span> <span class=s>`form:&#34;desc,optional&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetPromptOptionResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Items</span> <span class=p>[]</span><span class=o>*</span><span class=nx>PromptOption</span> <span class=s>`json:&#34;items&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Total</span> <span class=kt>int64</span> <span class=s>`json:&#34;total&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=11-新增-prompt-option>11. &ldquo;新增 Prompt Option&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/prompt-option</li><li>Method: POST</li><li>Request: <code>AddPromptOptionReq</code></li><li>Response: <code>AddPromptOptionResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>AddPromptOptionReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&#34;name&#34;`</span> <span class=c1>// 选项名
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Prompt</span> <span class=kt>string</span> <span class=s>`json:&#34;prompt&#34;`</span> <span class=c1>// prompt
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>NegativePrompt</span> <span class=kt>string</span> <span class=s>`json:&#34;negativePrompt&#34;`</span> <span class=c1>// 负面prompt
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Desc</span> <span class=kt>string</span> <span class=s>`json:&#34;desc,optional&#34;`</span> <span class=c1>// 描述
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>AddPromptOptionResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`json:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=12-修改-prompt-option>12. &ldquo;修改 Prompt Option&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/prompt-option/:id</li><li>Method: PUT</li><li>Request: <code>UpdatePromptOptionReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>UpdatePromptOptionReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`path:&#34;id&#34;`</span> <span class=c1>// 序号
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&#34;name&#34;`</span> <span class=c1>// 选项名
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Prompt</span> <span class=kt>string</span> <span class=s>`json:&#34;prompt&#34;`</span> <span class=c1>// prompt
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>NegativePrompt</span> <span class=kt>string</span> <span class=s>`json:&#34;negativePrompt&#34;`</span> <span class=c1>// 负面prompt
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Desc</span> <span class=kt>string</span> <span class=s>`json:&#34;desc,optional&#34;`</span> <span class=c1>// 描述
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h3 id=13-删除-prompt-option>13. &ldquo;删除 Prompt Option&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/prompt-option/:id</li><li>Method: DELETE</li><li>Request: <code>DeletePromptOptionReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>DeletePromptOptionReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`path:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h3 id=14-获取全部-prompt-option>14. &ldquo;获取全部 Prompt Option&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/prompt-option/all</li><li>Method: GET</li><li>Request: <code>GetPromptOptionReq</code></li><li>Response: <code>GetPromptOptionResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetPromptOptionReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Page</span> <span class=kt>int</span> <span class=s>`form:&#34;page,default=1&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Size</span> <span class=kt>int</span> <span class=s>`form:&#34;size,default=10&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`form:&#34;name,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Prompt</span> <span class=kt>string</span> <span class=s>`form:&#34;prompt,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>NegativePrompt</span> <span class=kt>string</span> <span class=s>`form:&#34;negativePrompt,optional&#34;`</span> <span class=c1>// 负面prompt
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Desc</span> <span class=kt>string</span> <span class=s>`form:&#34;desc,optional&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetPromptOptionResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Items</span> <span class=p>[]</span><span class=o>*</span><span class=nx>PromptOption</span> <span class=s>`json:&#34;items&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Total</span> <span class=kt>int64</span> <span class=s>`json:&#34;total&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=15-新增资源>15. &ldquo;新增资源&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/resource</li><li>Method: POST</li><li>Request: <code>AddResourceReq</code></li><li>Response: <code>AddResourceResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>AddResourceReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&#34;name&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Code</span> <span class=kt>string</span> <span class=s>`json:&#34;code&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Type</span> <span class=kt>string</span> <span class=s>`json:&#34;type,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>ParentID</span> <span class=kt>int</span> <span class=s>`json:&#34;parentId,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Path</span> <span class=kt>string</span> <span class=s>`json:&#34;path,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Icon</span> <span class=kt>string</span> <span class=s>`json:&#34;icon,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Component</span> <span class=kt>string</span> <span class=s>`json:&#34;component,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>IsShow</span> <span class=kt>bool</span> <span class=s>`json:&#34;isShow,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>IsEnable</span> <span class=kt>bool</span> <span class=s>`json:&#34;isEnable,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Order</span> <span class=kt>int</span> <span class=s>`json:&#34;order&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>AddResourceResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`json:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=16-修改资源>16. &ldquo;修改资源&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/resource/:id</li><li>Method: PUT</li><li>Request: <code>SaveResourceReq</code></li><li>Response: <code>SaveResourceResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>SaveResourceReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`path:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&#34;name&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Code</span> <span class=kt>string</span> <span class=s>`json:&#34;code&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Type</span> <span class=kt>string</span> <span class=s>`json:&#34;type,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>ParentID</span> <span class=kt>int</span> <span class=s>`json:&#34;parentId,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Path</span> <span class=kt>string</span> <span class=s>`json:&#34;path,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Icon</span> <span class=kt>string</span> <span class=s>`json:&#34;icon,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Component</span> <span class=kt>string</span> <span class=s>`json:&#34;component,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>IsShow</span> <span class=kt>bool</span> <span class=s>`json:&#34;isShow,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>IsEnable</span> <span class=kt>bool</span> <span class=s>`json:&#34;isEnable,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Order</span> <span class=kt>int</span> <span class=s>`json:&#34;order&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>SaveResourceResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`json:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=17-删除资源>17. &ldquo;删除资源&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/resource/:id</li><li>Method: DELETE</li><li>Request: <code>DeleteResourceReq</code></li><li>Response: <code>DeleteResourceResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>DeleteResourceReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`path:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>DeleteResourceResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>DelectCount</span> <span class=kt>int</span> <span class=s>`json:&#34;deleteCount&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=18-获取菜单资源树>18. &ldquo;获取菜单资源树&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/resource/menu/tree</li><li>Method: GET</li><li>Request: <code>-</code></li><li>Response: <code>GetResourceTreeResp</code></li></ul><ol start=2><li><p>request definition</p></li><li><p>response definition</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetResourceTreeResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Resource</span> <span class=p>[]</span><span class=o>*</span><span class=nx>Resource</span> <span class=s>`json:&#34;resource&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=19-给用户分配角色>19. &ldquo;给用户分配角色&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/assign/roles</li><li>Method: PUT</li><li>Request: <code>AssignRolesReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>AssignRolesReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`json:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>RoleId</span> <span class=kt>uint64</span> <span class=s>`json:&#34;roleId&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Username</span> <span class=kt>string</span> <span class=s>`json:&#34;username&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h3 id=20-新增角色>20. &ldquo;新增角色&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/role</li><li>Method: POST</li><li>Request: <code>AddRoleReq</code></li><li>Response: <code>AddRoleResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>AddRoleReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Code</span> <span class=kt>string</span> <span class=s>`json:&#34;code&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&#34;name&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>IsEnable</span> <span class=kt>bool</span> <span class=s>`json:&#34;isEnable&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>ResourceIds</span> <span class=p>[]</span><span class=kt>uint64</span> <span class=s>`json:&#34;resourceIds&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>AddRoleResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`json:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=21-更新角色>21. &ldquo;更新角色&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/role/:id</li><li>Method: PUT</li><li>Request: <code>UpdateRoleReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>UpdateRoleReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`path:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Code</span> <span class=kt>string</span> <span class=s>`json:&#34;code&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`json:&#34;name&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>IsEnable</span> <span class=kt>bool</span> <span class=s>`json:&#34;isEnable&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>ResourceIds</span> <span class=p>[]</span><span class=kt>uint64</span> <span class=s>`json:&#34;resourceIds&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h3 id=22-删除角色>22. &ldquo;删除角色&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/role/:id</li><li>Method: DELETE</li><li>Request: <code>DeleteRoleReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>DeleteRoleReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`path:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h3 id=23-查询角色>23. &ldquo;查询角色&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/role/all</li><li>Method: GET</li><li>Request: <code>GetRoleAllReq</code></li><li>Response: <code>GetRoleAllResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetRoleAllReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Code</span> <span class=kt>string</span> <span class=s>`form:&#34;code,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`form:&#34;name,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>IsEnable</span> <span class=kt>bool</span> <span class=s>`form:&#34;isEnable,default=false&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetRoleAllResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Items</span> <span class=p>[]</span><span class=o>*</span><span class=nx>Role</span> <span class=s>`json:&#34;items&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=24-分页查询角色>24. &ldquo;分页查询角色&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/role/page</li><li>Method: GET</li><li>Request: <code>GetRolePageReq</code></li><li>Response: <code>GetRolePageResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetRolePageReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Page</span> <span class=kt>int</span> <span class=s>`form:&#34;page,default=1&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Size</span> <span class=kt>int</span> <span class=s>`form:&#34;size,default=10&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Code</span> <span class=kt>string</span> <span class=s>`form:&#34;code,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span> <span class=s>`form:&#34;name,optional&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetRolePageResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Items</span> <span class=p>[]</span><span class=o>*</span><span class=nx>Role</span> <span class=s>`json:&#34;items&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Total</span> <span class=kt>int64</span> <span class=s>`json:&#34;total&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=25-分页查询系统参数>25. &ldquo;分页查询系统参数&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/sys-param</li><li>Method: GET</li><li>Request: <code>GetSysParamReq</code></li><li>Response: <code>GetSysParamResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetSysParamReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Page</span> <span class=kt>int</span> <span class=s>`form:&#34;page,default=1&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Size</span> <span class=kt>int</span> <span class=s>`form:&#34;size,default=10&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Key</span> <span class=kt>string</span> <span class=s>`form:&#34;key,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Value</span> <span class=kt>string</span> <span class=s>`form:&#34;value,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Desc</span> <span class=kt>string</span> <span class=s>`form:&#34;desc,optional&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetSysParamResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Items</span> <span class=p>[]</span><span class=o>*</span><span class=nx>SysParam</span> <span class=s>`json:&#34;items&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Total</span> <span class=kt>int64</span> <span class=s>`json:&#34;total&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=26-新增系统参数>26. &ldquo;新增系统参数&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/sys-param</li><li>Method: POST</li><li>Request: <code>AddSysParamReq</code></li><li>Response: <code>AddSysParamResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>AddSysParamReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Key</span> <span class=kt>string</span> <span class=s>`json:&#34;key&#34;`</span> <span class=c1>// 键
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Value</span> <span class=kt>string</span> <span class=s>`json:&#34;value&#34;`</span> <span class=c1>// 值
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Desc</span> <span class=kt>string</span> <span class=s>`json:&#34;desc,optional&#34;`</span> <span class=c1>// 描述
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>AddSysParamResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`json:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=27-修改系统参数>27. &ldquo;修改系统参数&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/sys-param/:id</li><li>Method: PUT</li><li>Request: <code>UpdateSysParamReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>UpdateSysParamReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`path:&#34;id&#34;`</span> <span class=c1>// 序号
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Key</span> <span class=kt>string</span> <span class=s>`json:&#34;key&#34;`</span> <span class=c1>// 键
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Value</span> <span class=kt>string</span> <span class=s>`json:&#34;value&#34;`</span> <span class=c1>// 值
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Desc</span> <span class=kt>string</span> <span class=s>`json:&#34;desc,optional&#34;`</span> <span class=c1>// 描述
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h3 id=28-删除系统参数>28. &ldquo;删除系统参数&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/sys-param/:id</li><li>Method: DELETE</li><li>Request: <code>DeleteSysParamReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>DeleteSysParamReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`path:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h3 id=29-获取单个系统参数>29. &ldquo;获取单个系统参数&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/sys-param/single</li><li>Method: GET</li><li>Request: <code>GetSysParamReq</code></li><li>Response: <code>SysParam</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetSysParamReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Page</span> <span class=kt>int</span> <span class=s>`form:&#34;page,default=1&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Size</span> <span class=kt>int</span> <span class=s>`form:&#34;size,default=10&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Key</span> <span class=kt>string</span> <span class=s>`form:&#34;key,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Value</span> <span class=kt>string</span> <span class=s>`form:&#34;value,optional&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Desc</span> <span class=kt>string</span> <span class=s>`form:&#34;desc,optional&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>SysParam</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`json:&#34;id&#34;`</span> <span class=c1>// 序号
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>CreatedAt</span> <span class=kt>int64</span> <span class=s>`json:&#34;createdAt&#34;`</span> <span class=c1>// 创建时间
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>UpdatedAt</span> <span class=kt>int64</span> <span class=s>`json:&#34;updatedAt&#34;`</span> <span class=c1>// 更新时间
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Key</span> <span class=kt>string</span> <span class=s>`json:&#34;key&#34;`</span> <span class=c1>// 键
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Value</span> <span class=kt>string</span> <span class=s>`json:&#34;value&#34;`</span> <span class=c1>// 值
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Desc</span> <span class=kt>string</span> <span class=s>`json:&#34;desc&#34;`</span> <span class=c1>// 描述
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=30-分页查询用户>30. &ldquo;分页查询用户&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/user</li><li>Method: GET</li><li>Request: <code>GetUserPageReq</code></li><li>Response: <code>GetUserPageResp</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetUserPageReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Page</span> <span class=kt>int</span> <span class=s>`form:&#34;page,default=1&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Size</span> <span class=kt>int</span> <span class=s>`form:&#34;size,default=10&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Username</span> <span class=kt>string</span> <span class=s>`form:&#34;username,optional&#34;`</span> <span class=c1>// 用户名
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetUserPageResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Items</span> <span class=p>[]</span><span class=o>*</span><span class=nx>User</span> <span class=s>`json:&#34;items&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Total</span> <span class=kt>int64</span> <span class=s>`json:&#34;total&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=31-更新角色>31. &ldquo;更新角色&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/user/:id</li><li>Method: PUT</li><li>Request: <code>UpdateUserReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>UpdateUserReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`path:&#34;id&#34;`</span> <span class=c1>// 序号
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>IsEnable</span> <span class=kt>bool</span> <span class=s>`json:&#34;isEnable&#34;`</span> <span class=c1>// 是否启用:0-禁用;1-启用
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h3 id=32-获取全部角色>32. &ldquo;获取全部角色&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/user/all</li><li>Method: GET</li><li>Request: <code>-</code></li><li>Response: <code>GetUserPageResp</code></li></ul><ol start=2><li><p>request definition</p></li><li><p>response definition</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetUserPageResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Items</span> <span class=p>[]</span><span class=o>*</span><span class=nx>User</span> <span class=s>`json:&#34;items&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Total</span> <span class=kt>int64</span> <span class=s>`json:&#34;total&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=33-获取用户详情>33. &ldquo;获取用户详情&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/user/detail</li><li>Method: GET</li><li>Request: <code>-</code></li><li>Response: <code>GetUserDetailResp</code></li></ul><ol start=2><li><p>request definition</p></li><li><p>response definition</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GetUserDetailResp</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`json:&#34;id&#34;`</span> <span class=c1>// 序号
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>CreatedAt</span> <span class=kt>int64</span> <span class=s>`json:&#34;createdAt&#34;`</span> <span class=c1>// 创建时间
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>UpdatedAt</span> <span class=kt>int64</span> <span class=s>`json:&#34;updatedAt&#34;`</span> <span class=c1>// 更新时间
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Username</span> <span class=kt>string</span> <span class=s>`json:&#34;username&#34;`</span> <span class=c1>// 账号
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>LastLogin</span> <span class=kt>int64</span> <span class=s>`json:&#34;lastLogin&#34;`</span> <span class=c1>// 最后登录时间
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>IsEnable</span> <span class=kt>bool</span> <span class=s>`json:&#34;isEnable&#34;`</span> <span class=c1>// 是否启用:0-禁用;1-启用
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Role</span> <span class=o>*</span><span class=nx>Role</span> <span class=s>`json:&#34;role&#34;`</span> <span class=c1>// 角色
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=34-用户修改密码>34. &ldquo;用户修改密码&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/user/password/change</li><li>Method: POST</li><li>Request: <code>ChangeUserPasswordReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>ChangeUserPasswordReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>OldPassword</span> <span class=kt>string</span> <span class=s>`json:&#34;oldPassword&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>NewPassword</span> <span class=kt>string</span> <span class=s>`json:&#34;newPassword&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h3 id=35-重置密码>35. &ldquo;重置密码&rdquo;</h3><ol><li>route definition</li></ol><ul><li>Url: /api/v1/user/password/reset/:id</li><li>Method: PUT</li><li>Request: <code>ResetUserPasswordReq</code></li><li>Response: <code>-</code></li></ul><ol start=2><li>request definition</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>type</span> <span class=nx>ResetUserPasswordReq</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ID</span> <span class=kt>uint64</span> <span class=s>`path:&#34;id&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Password</span> <span class=kt>string</span> <span class=s>`json:&#34;password&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>response definition</li></ol><h2 id=运维需求>运维需求</h2><h3 id=mysql-服务部署>MySQL 服务部署</h3><p>使用 docker 部署，具体见 <a href=#docker-compose rel>docker compose</a> 文件</p><h3 id=redis-服务部署>Redis 服务部署</h3><p>使用 docker 部署，具体见 <a href=#docker-compose rel>docker compose</a> 文件</p><h3 id=nginx-服务部署>Nginx 服务部署</h3><p>使用 docker 部署，具体见 <a href=#docker-compose rel>docker compose</a> 文件</p><p><code>/usr/local/nginx/nginx.conf</code>文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>user</span>  <span class=n>nginx</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>worker_processes</span>  <span class=n>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>error_log</span>  <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>nginx</span><span class=o>/</span><span class=n>error</span><span class=o>.</span><span class=n>log</span> <span class=n>notice</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>pid</span>        <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>nginx</span><span class=o>.</span><span class=n>pid</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>events</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>worker_connections</span>  <span class=mi>1024</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>include</span>       <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>nginx</span><span class=o>/</span><span class=n>mime</span><span class=o>.</span><span class=n>types</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>default_type</span>  <span class=n>application</span><span class=o>/</span><span class=n>octet</span><span class=o>-</span><span class=n>stream</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>log_format</span>  <span class=n>main</span>  <span class=s1>&#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; &#39;</span>
</span></span><span class=line><span class=cl>                      <span class=s1>&#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;</span>
</span></span><span class=line><span class=cl>                      <span class=s1>&#39;&#34;$http_user_agent&#34; &#34;$http_x_forwarded_for&#34;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>access_log</span>  <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>nginx</span><span class=o>/</span><span class=n>access</span><span class=o>.</span><span class=n>log</span>  <span class=n>main</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>sendfile</span>        <span class=n>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>#tcp_nopush     on;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>keepalive_timeout</span>  <span class=mi>65</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>#gzip  on;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 注意要添加这一行</span>
</span></span><span class=line><span class=cl>    <span class=n>include</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>nginx</span><span class=o>/</span><span class=n>conf</span><span class=o>.</span><span class=n>d</span><span class=o>/*.</span><span class=n>conf</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>/usr/local/nginx/conf.d/default.conf</code>文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>server{
</span></span><span class=line><span class=cl>        listen 80;
</span></span><span class=line><span class=cl>        server_name localhost docker.xieboke.net;
</span></span><span class=line><span class=cl>        charset utf-8;
</span></span><span class=line><span class=cl>        client_max_body_size 32m;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        location / {
</span></span><span class=line><span class=cl>                # 此处一定要改成nginx容器中的目录地址，宿主机上的地址容器访问不到
</span></span><span class=line><span class=cl>                # 命令必须用 root, 不能用 alias
</span></span><span class=line><span class=cl>                root   /usr/share/nginx/html;
</span></span><span class=line><span class=cl>                try_files $uri $uri/ /index.html;
</span></span><span class=line><span class=cl>                index  index.html index.htm;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        location /file/ {
</span></span><span class=line><span class=cl>                proxy_pass http://[your_ip]:[your_port]/api/v1/file/;
</span></span><span class=line><span class=cl>                proxy_set_header Host $host;
</span></span><span class=line><span class=cl>                proxy_set_header X-Real-IP $remote_addr;
</span></span><span class=line><span class=cl>                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        location ^~ /api/ {
</span></span><span class=line><span class=cl>                proxy_pass http://[your_ip]:[your_port]/api/v1/;
</span></span><span class=line><span class=cl>                proxy_set_header Host $host;
</span></span><span class=line><span class=cl>                proxy_set_header X-Real-IP $remote_addr;
</span></span><span class=line><span class=cl>                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class=line><span class=cl>                proxy_set_header REMOTE-HOST $remote_addr;
</span></span><span class=line><span class=cl>                proxy_set_header Upgrade $http_upgrade;
</span></span><span class=line><span class=cl>                proxy_set_header Connection &#34;upgrade&#34;;
</span></span><span class=line><span class=cl>                proxy_set_header X-Forwarded-Proto $scheme;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        #error_page  404              /404.html;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        # redirect server error pages to the static page /50x.html
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        error_page   500 502 503 504  /50x.html;
</span></span><span class=line><span class=cl>        location = /50x.html {
</span></span><span class=line><span class=cl>                root   html;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h3 id=docker-compose>Docker Compose</h3><p>新建 docker-compose.yaml 文件，写入下列内容：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;3.7&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>mysql</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>mysql:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MYSQL_ROOT_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=l>your_mysql_password</span><span class=w> </span><span class=c># 需要修改</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MYSQL_DATABASE</span><span class=p>:</span><span class=w> </span><span class=l>your_database</span><span class=w> </span><span class=c># 需要修改</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;3306:3306&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>mysql_data:/var/lib/mysql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>redis:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s2>&#34;redis-server&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s2>&#34;--requirepass&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=l>your_redis_password,</span><span class=w> </span><span class=c># 需要修改</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s2>&#34;--maxmemory&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s2>&#34;512mb&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s2>&#34;--maxmemory-policy&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s2>&#34;allkeys-lru&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;6379:6379&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>nginx</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;80:80&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;443:443&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/usr/local/nginx/html:/usr/share/nginx/html</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/usr/local/nginx/www:/var/www</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/usr/local/nginx/logs:/var/log/nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/usr/local/nginx/nginx.conf/:/etc/nginx/nginx.conf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/usr/local/nginx/etc/cert:/etc/nginx/cert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/usr/local/nginx/conf.d:/etc/nginx/conf.d</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>NGINX_PORT=80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>TZ=Asia/Shanghai</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>privileged</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>mysql_data</span><span class=p>:</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>执行命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker compose up -d
</span></span></code></pre></td></tr></table></div></div><h3 id=前端部署>前端部署</h3><p>通过自写脚本，完成自动化发布流程：</p><ol><li>打包 <code>src</code></li><li>压缩 <code>dist</code> 目录成 <code>dist.tar.gz</code></li><li>把压缩包上传到服务器</li><li>服务器解压缩目录到<code>/usr/local/nginx/html</code></li><li>删除<code>dist.tar.gz</code>文件</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-makefile data-lang=makefile><span class=line><span class=cl><span class=nf>deploy</span><span class=o>:</span>
</span></span><span class=line><span class=cl>	@pnpm run build
</span></span><span class=line><span class=cl>	@tar -czvf dist.tar.gz -C dist .
</span></span><span class=line><span class=cl>	@scp dist.tar.gz server:/home/ubuntu
</span></span><span class=line><span class=cl>	@ssh server <span class=s2>&#34;sudo tar -xzvf /home/ubuntu/dist.tar.gz -C /usr/local/nginx/html&#34;</span>
</span></span><span class=line><span class=cl>	@rm dist.tar.gz
</span></span></code></pre></td></tr></table></div></div><h3 id=后端部署>后端部署</h3><p>通过 ansible 进行自动化部署</p><p><code>inventory</code>文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>web_servers</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>user</span><span class=err>@</span><span class=nx>ip</span> <span class=c># 自行修改</span>
</span></span></code></pre></td></tr></table></div></div><p><code>ansible.yaml</code>文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy and restart service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>user@ip</span><span class=w> </span><span class=c># 自行修改</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>become</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tasks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Stop remote service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>systemd</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>magic-camera.service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ignore_errors</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Copy compiled binary to remote server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ansible.builtin.copy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>src</span><span class=p>:</span><span class=w> </span><span class=l>../target/magic-camera-amd64-linux</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>dest</span><span class=p>:</span><span class=w> </span><span class=l>/usr/local/bin/magic-camera-backend/magic-camera</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>mode</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0755&#34;</span><span class=w> </span><span class=c># 设置文件权限为可执行</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Copy config file to remote server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ansible.builtin.copy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>src</span><span class=p>:</span><span class=w> </span><span class=l>../app/etc/config-product.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>dest</span><span class=p>:</span><span class=w> </span><span class=l>/usr/local/bin/magic-camera-backend/config.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>mode</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0644&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Start remote service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>systemd</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>magic-camera.service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>started</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Get service status</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;systemctl status magic-camera.service&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>register</span><span class=p>:</span><span class=w> </span><span class=l>status_output</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>msg</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Service status: {{ status_output }}&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><code>Makefile</code>文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-makefile data-lang=makefile><span class=line><span class=cl><span class=nv>TARGET_DIR</span><span class=o>=</span><span class=s2>&#34;target&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>BINARY_NAME</span><span class=o>=</span><span class=s2>&#34;magic-camera&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>MAIN_GO</span><span class=o>=</span>app/app.go
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>dep</span><span class=o>:</span>
</span></span><span class=line><span class=cl>	@go mod download
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>check</span><span class=o>:</span>
</span></span><span class=line><span class=cl>	@go fmt ./...
</span></span><span class=line><span class=cl>	@go vet ./...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>build</span><span class=o>:</span> <span class=n>dep</span> <span class=n>check</span>
</span></span><span class=line><span class=cl>	@mkdir -p <span class=si>${</span><span class=nv>TARGET_DIR</span><span class=si>}</span>
</span></span><span class=line><span class=cl>	@GOARCH<span class=o>=</span>arm64 <span class=nv>GOOS</span><span class=o>=</span>darwin go build -o <span class=si>${</span><span class=nv>TARGET_DIR</span><span class=si>}</span>/<span class=si>${</span><span class=nv>BINARY_NAME</span><span class=si>}</span>-arm64-darwin <span class=si>${</span><span class=nv>MAIN_GO</span><span class=si>}</span>
</span></span><span class=line><span class=cl>	@GOARCH<span class=o>=</span>amd64 <span class=nv>GOOS</span><span class=o>=</span>darwin go build -o <span class=si>${</span><span class=nv>TARGET_DIR</span><span class=si>}</span>/<span class=si>${</span><span class=nv>BINARY_NAME</span><span class=si>}</span>-amd64-darwin <span class=si>${</span><span class=nv>MAIN_GO</span><span class=si>}</span>
</span></span><span class=line><span class=cl>	@GOARCH<span class=o>=</span>amd64 <span class=nv>GOOS</span><span class=o>=</span>linux go build -o <span class=si>${</span><span class=nv>TARGET_DIR</span><span class=si>}</span>/<span class=si>${</span><span class=nv>BINARY_NAME</span><span class=si>}</span>-amd64-linux <span class=si>${</span><span class=nv>MAIN_GO</span><span class=si>}</span>
</span></span><span class=line><span class=cl>	@GOARCH<span class=o>=</span>amd64 <span class=nv>GOOS</span><span class=o>=</span>windows go build -o <span class=si>${</span><span class=nv>TARGET_DIR</span><span class=si>}</span>/<span class=si>${</span><span class=nv>BINARY_NAME</span><span class=si>}</span>-amd64-windows <span class=si>${</span><span class=nv>MAIN_GO</span><span class=si>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>deploy</span><span class=o>:</span> <span class=n>build</span>
</span></span><span class=line><span class=cl>	@ansible-playbook -i ansible/inventory ansible/ansible.yaml
</span></span></code></pre></td></tr></table></div></div><h3 id=prometheus-部署>Prometheus 部署</h3><ol><li>下载 Prometheus 文件，并且放置到各个文件夹下</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>wget https://github.com/prometheus/prometheus/releases/download/v2.45.4/prometheus-2.45.4.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>tar -xvf prometheus-2.45.4.linux-amd64.tar.gz
</span></span><span class=line><span class=cl><span class=nb>cd</span> prometheus-2.45.4.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>sudo cp prometheus promtool /usr/local/bin
</span></span><span class=line><span class=cl>sudo cp -r prometheus.yml consoles console_libraries /etc/prometheus
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>创建 Prometheus 服务</li></ol><p>新建文件<code>/etc/systemd/system/prometheus.service</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>Unit</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>Description</span><span class=p>=</span><span class=nx>Prometheus</span>
</span></span><span class=line><span class=cl><span class=nx>Wants</span><span class=p>=</span><span class=nx>network-online</span><span class=p>.</span><span class=nx>target</span>
</span></span><span class=line><span class=cl><span class=nx>After</span><span class=p>=</span><span class=nx>network-online</span><span class=p>.</span><span class=nx>target</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Service</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>User</span><span class=p>=</span><span class=nx>root</span>
</span></span><span class=line><span class=cl><span class=nx>Group</span><span class=p>=</span><span class=nx>root</span>
</span></span><span class=line><span class=cl><span class=nx>Type</span><span class=p>=</span><span class=nx>simple</span>
</span></span><span class=line><span class=cl><span class=nx>Restart</span><span class=p>=</span><span class=nx>always</span>
</span></span><span class=line><span class=cl><span class=nx>ExecStart</span><span class=p>=</span><span class=err>/</span><span class=nx>usr</span><span class=err>/</span><span class=nx>local</span><span class=err>/</span><span class=nx>bin</span><span class=err>/</span><span class=nx>prometheus</span> <span class=err>\</span>
</span></span><span class=line><span class=cl>    <span class=nx>--config</span><span class=p>.</span><span class=nx>file</span> <span class=err>/</span><span class=nx>etc</span><span class=err>/</span><span class=nx>prometheus</span><span class=err>/</span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>yml</span> <span class=err>\</span>
</span></span><span class=line><span class=cl>    <span class=nx>--storage</span><span class=p>.</span><span class=nx>tsdb</span><span class=p>.</span><span class=nx>path</span> <span class=err>/</span><span class=nx>var</span><span class=err>/</span><span class=nx>lib</span><span class=err>/</span><span class=nx>prometheus</span><span class=err>/</span> <span class=err>\</span>
</span></span><span class=line><span class=cl>    <span class=nx>--web</span><span class=p>.</span><span class=nx>console</span><span class=p>.</span><span class=nx>templates</span><span class=p>=</span><span class=err>/</span><span class=nx>etc</span><span class=err>/</span><span class=nx>prometheus</span><span class=err>/</span><span class=nx>consoles</span> <span class=err>\</span>
</span></span><span class=line><span class=cl>    <span class=nx>--web</span><span class=p>.</span><span class=nx>console</span><span class=p>.</span><span class=nx>libraries</span><span class=p>=</span><span class=err>/</span><span class=nx>etc</span><span class=err>/</span><span class=nx>prometheus</span><span class=err>/</span><span class=nx>console_libraries</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Install</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>WantedBy</span><span class=p>=</span><span class=nx>multi-user</span><span class=p>.</span><span class=nx>target</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>启动服务</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>sudo systemctl start prometheus
</span></span><span class=line><span class=cl>sudo systemctl status prometheus
</span></span></code></pre></td></tr></table></div></div><p>出现下列 <code>active</code> 信息即可，<code>Prometheus</code> 服务运行在<code>:9090</code>端口</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>●</span> <span class=n>prometheus</span><span class=o>.</span><span class=n>service</span> <span class=o>-</span> <span class=n>Prometheus</span>
</span></span><span class=line><span class=cl>     <span class=n>Loaded</span><span class=p>:</span> <span class=n>loaded</span> <span class=p>(</span><span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>system</span><span class=o>/</span><span class=n>prometheus</span><span class=o>.</span><span class=n>service</span><span class=p>;</span> <span class=n>disabled</span><span class=p>;</span> <span class=n>vendor</span> <span class=n>preset</span><span class=p>:</span> <span class=n>enabled</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>Active</span><span class=p>:</span> <span class=n>active</span> <span class=p>(</span><span class=n>running</span><span class=p>)</span> <span class=n>since</span> <span class=n>Sun</span> <span class=mi>2024</span><span class=o>-</span><span class=mi>04</span><span class=o>-</span><span class=mi>14</span> <span class=mi>20</span><span class=p>:</span><span class=mi>15</span><span class=p>:</span><span class=mi>00</span> <span class=n>CST</span><span class=p>;</span> <span class=mi>4</span> <span class=n>days</span> <span class=n>ago</span>
</span></span><span class=line><span class=cl>   <span class=n>Main</span> <span class=n>PID</span><span class=p>:</span> <span class=mi>3218298</span> <span class=p>(</span><span class=n>prometheus</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>Tasks</span><span class=p>:</span> <span class=mi>9</span> <span class=p>(</span><span class=n>limit</span><span class=p>:</span> <span class=mi>2247</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>Memory</span><span class=p>:</span> <span class=mf>129.0</span><span class=n>M</span>
</span></span><span class=line><span class=cl>     <span class=n>CGroup</span><span class=p>:</span> <span class=o>/</span><span class=n>system</span><span class=o>.</span><span class=n>slice</span><span class=o>/</span><span class=n>prometheus</span><span class=o>.</span><span class=n>service</span>
</span></span><span class=line><span class=cl>             <span class=err>└─</span><span class=mi>3218298</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>prometheus</span> <span class=o>--</span><span class=n>config</span><span class=o>.</span><span class=n>file</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>prometheus</span><span class=o>/</span><span class=n>prometheus</span><span class=o>.</span><span class=n>yml</span> <span class=o>--</span><span class=n>storage</span><span class=o>.</span><span class=n>tsdb</span><span class=o>.</span><span class=n>path</span> <span class=o>/</span><span class=k>var</span><span class=o>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>Prometheus 配置文件：<code>/etc/prometheus/prometheus.yml</code></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># my global config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>global</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>15s</span><span class=w> </span><span class=c># Set the scrape interval to every 15 seconds. Default is every 1 minute.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>evaluation_interval</span><span class=p>:</span><span class=w> </span><span class=l>15s</span><span class=w> </span><span class=c># Evaluate rules every 15 seconds. The default is every 1 minute.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># scrape_timeout is set to the global default (10s).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Alertmanager configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>alerting</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>alertmanagers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=c># - alertmanager:9093</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Load rules once and periodically evaluate them according to the global &#39;evaluation_interval&#39;.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>rule_files</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># - &#34;first_rules.yml&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># - &#34;second_rules.yml&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># A scrape configuration containing exactly one endpoint to scrape:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Here it&#39;s Prometheus itself.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;prometheus&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># metrics_path defaults to &#39;/metrics&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># scheme defaults to &#39;http&#39;.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;localhost:9090&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;node_exporter&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;localhost:9100&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;mysqld_exporter&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;localhost:9104&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;magic_camera&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;localhost:6470&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;redis_exporter&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;localhost:9121&#34;</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=部署-node-exporter>部署 Node Exporter</h3><ol><li>下载 node_exporter 文件，并且放置到各个文件夹下</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>wget wget https://github.com/prometheus/node_exporter/releases/download/v1.7.0/node_exporter-1.7.0.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>tar -xvf node_exporter-1.7.0.linux-amd64.tar.gz
</span></span><span class=line><span class=cl><span class=nb>cd</span> node_exporter-1.7.0.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>sudo cp node_exporter /usr/local/bin
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>创建 node_exporter 服务</li></ol><p>新建文件<code>/etc/systemd/system/node_exporter.service</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>Unit</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>Description</span><span class=p>=</span><span class=nx>Node</span> <span class=nx>Exporter</span>
</span></span><span class=line><span class=cl><span class=nx>Wants</span><span class=p>=</span><span class=nx>network-online</span><span class=p>.</span><span class=nx>target</span>
</span></span><span class=line><span class=cl><span class=nx>After</span><span class=p>=</span><span class=nx>network-online</span><span class=p>.</span><span class=nx>target</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Service</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>User</span><span class=p>=</span><span class=nx>root</span>
</span></span><span class=line><span class=cl><span class=nx>Group</span><span class=p>=</span><span class=nx>root</span>
</span></span><span class=line><span class=cl><span class=nx>Type</span><span class=p>=</span><span class=nx>simple</span>
</span></span><span class=line><span class=cl><span class=nx>Restart</span><span class=p>=</span><span class=nx>always</span>
</span></span><span class=line><span class=cl><span class=nx>ExecStart</span><span class=p>=</span><span class=err>/</span><span class=nx>usr</span><span class=err>/</span><span class=nx>local</span><span class=err>/</span><span class=nx>bin</span><span class=err>/</span><span class=nx>node_exporter</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Install</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>WantedBy</span><span class=p>=</span><span class=nx>multi-user</span><span class=p>.</span><span class=nx>target</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>启动服务</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>sudo systemctl start node_exporter
</span></span><span class=line><span class=cl>sudo systemctl status node_exporter
</span></span></code></pre></td></tr></table></div></div><p>出现下列 <code>active</code> 信息即可，<code>node_exporter</code> 服务运行在<code>:9100</code>端口</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>●</span> <span class=n>node_exporter</span><span class=o>.</span><span class=n>service</span> <span class=o>-</span> <span class=ne>Node</span> <span class=n>Exporter</span>
</span></span><span class=line><span class=cl>     <span class=n>Loaded</span><span class=p>:</span> <span class=n>loaded</span> <span class=p>(</span><span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>system</span><span class=o>/</span><span class=n>node_exporter</span><span class=o>.</span><span class=n>service</span><span class=p>;</span> <span class=n>disabled</span><span class=p>;</span> <span class=n>vendor</span> <span class=n>preset</span><span class=p>:</span> <span class=n>enabled</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>Active</span><span class=p>:</span> <span class=n>active</span> <span class=p>(</span><span class=n>running</span><span class=p>)</span> <span class=n>since</span> <span class=n>Sun</span> <span class=mi>2024</span><span class=o>-</span><span class=mi>04</span><span class=o>-</span><span class=mi>14</span> <span class=mi>19</span><span class=p>:</span><span class=mi>36</span><span class=p>:</span><span class=mi>13</span> <span class=n>CST</span><span class=p>;</span> <span class=mi>4</span> <span class=n>days</span> <span class=n>ago</span>
</span></span><span class=line><span class=cl>   <span class=n>Main</span> <span class=n>PID</span><span class=p>:</span> <span class=mi>3207091</span> <span class=p>(</span><span class=n>node_exporter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>Tasks</span><span class=p>:</span> <span class=mi>4</span> <span class=p>(</span><span class=n>limit</span><span class=p>:</span> <span class=mi>2247</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>Memory</span><span class=p>:</span> <span class=mf>14.4</span><span class=n>M</span>
</span></span><span class=line><span class=cl>     <span class=n>CGroup</span><span class=p>:</span> <span class=o>/</span><span class=n>system</span><span class=o>.</span><span class=n>slice</span><span class=o>/</span><span class=n>node_exporter</span><span class=o>.</span><span class=n>service</span>
</span></span><span class=line><span class=cl>             <span class=err>└─</span><span class=mi>3207091</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>node_exporter</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=部署-mysqld-exporter>部署 MySQLd Exporter</h3><ol><li>下载 mysqld_exporter 文件，并且放置到各个文件夹下</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>wget https://github.com/prometheus/mysqld_exporter/releases/download/v0.15.1/mysqld_exporter-0.15.1.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>tar -xvf mysqld_exporter-0.15.1.linux-amd64.tar.gz
</span></span><span class=line><span class=cl><span class=nb>cd</span> mysqld_exporter-0.15.1.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>sudo cp mysqld_exporter /usr/local/bin
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>mysqld_exporter 配置文件：<code>/etc/prometheus/mysqld_exporter/my.cnf</code></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>client</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>user</span><span class=p>=</span><span class=nx>root</span>
</span></span><span class=line><span class=cl><span class=nx>password</span><span class=p>=</span><span class=nx>your_mysql_password</span>
</span></span><span class=line><span class=cl><span class=nx>host</span><span class=p>=</span><span class=mf>127.0</span><span class=p>.</span><span class=mf>0.1</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>创建 mysqld_exporter 服务</li></ol><p>新建文件<code>/etc/systemd/system/mysqld_exporter.service</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>Unit</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>Description</span><span class=p>=</span><span class=nx>mysqld_exporter</span>
</span></span><span class=line><span class=cl><span class=nx>Wants</span><span class=p>=</span><span class=nx>network-online</span><span class=p>.</span><span class=nx>target</span>
</span></span><span class=line><span class=cl><span class=nx>After</span><span class=p>=</span><span class=nx>network-online</span><span class=p>.</span><span class=nx>target</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Service</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>Type</span><span class=p>=</span><span class=nx>simple</span>
</span></span><span class=line><span class=cl><span class=nx>User</span><span class=p>=</span><span class=nx>root</span>
</span></span><span class=line><span class=cl><span class=nx>Group</span><span class=p>=</span><span class=nx>root</span>
</span></span><span class=line><span class=cl><span class=nx>Environment</span><span class=p>=</span><span class=nx>DATA_SOURCE_NAME</span><span class=p>=</span><span class=nx>your_mysql_user</span><span class=err>:</span><span class=nx>your_mysql_password</span><span class=err>@(</span><span class=mf>127.0</span><span class=p>.</span><span class=mf>0.1</span><span class=err>:</span><span class=mi>3306</span><span class=err>)/</span>
</span></span><span class=line><span class=cl><span class=nx>ExecStart</span><span class=p>=</span><span class=err>/</span><span class=nx>usr</span><span class=err>/</span><span class=nx>local</span><span class=err>/</span><span class=nx>bin</span><span class=err>/</span><span class=nx>mysqld_exporter</span> <span class=nx>--config</span><span class=p>.</span><span class=nx>my-cnf</span><span class=p>=</span><span class=err>/</span><span class=nx>etc</span><span class=err>/</span><span class=nx>prometheus</span><span class=err>/</span><span class=nx>mysqld_exporter</span><span class=err>/</span><span class=nx>my</span><span class=p>.</span><span class=nx>cnf</span>
</span></span><span class=line><span class=cl><span class=nx>Restart</span><span class=p>=</span><span class=nx>always</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Install</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>WantedBy</span><span class=p>=</span><span class=nx>multi-user</span><span class=p>.</span><span class=nx>targe</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>启动服务</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>sudo systemctl start mysqld_exporter
</span></span><span class=line><span class=cl>sudo systemctl status mysqld_exporter
</span></span></code></pre></td></tr></table></div></div><p>出现下列 <code>active</code> 信息即可，<code>mysqld_exporter</code> 服务运行在<code>:9104</code>端口</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>●</span> <span class=n>mysqld_exporter</span><span class=o>.</span><span class=n>service</span> <span class=o>-</span> <span class=n>mysqld_exporter</span>
</span></span><span class=line><span class=cl>     <span class=n>Loaded</span><span class=p>:</span> <span class=n>loaded</span> <span class=p>(</span><span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>system</span><span class=o>/</span><span class=n>mysqld_exporter</span><span class=o>.</span><span class=n>service</span><span class=p>;</span> <span class=n>disabled</span><span class=p>;</span> <span class=n>vendor</span> <span class=n>preset</span><span class=p>:</span> <span class=n>enabled</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>Active</span><span class=p>:</span> <span class=n>active</span> <span class=p>(</span><span class=n>running</span><span class=p>)</span> <span class=n>since</span> <span class=n>Mon</span> <span class=mi>2024</span><span class=o>-</span><span class=mi>04</span><span class=o>-</span><span class=mi>15</span> <span class=mi>14</span><span class=p>:</span><span class=mi>48</span><span class=p>:</span><span class=mi>22</span> <span class=n>CST</span><span class=p>;</span> <span class=mi>4</span> <span class=n>days</span> <span class=n>ago</span>
</span></span><span class=line><span class=cl>   <span class=n>Main</span> <span class=n>PID</span><span class=p>:</span> <span class=mi>3504637</span> <span class=p>(</span><span class=n>mysqld_exporter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>Tasks</span><span class=p>:</span> <span class=mi>6</span> <span class=p>(</span><span class=n>limit</span><span class=p>:</span> <span class=mi>2247</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>Memory</span><span class=p>:</span> <span class=mf>12.3</span><span class=n>M</span>
</span></span><span class=line><span class=cl>     <span class=n>CGroup</span><span class=p>:</span> <span class=o>/</span><span class=n>system</span><span class=o>.</span><span class=n>slice</span><span class=o>/</span><span class=n>mysqld_exporter</span><span class=o>.</span><span class=n>service</span>
</span></span><span class=line><span class=cl>             <span class=err>└─</span><span class=mi>3504637</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>mysqld_exporter</span> <span class=o>--</span><span class=n>config</span><span class=o>.</span><span class=n>my</span><span class=o>-</span><span class=n>cnf</span><span class=o>=/</span><span class=n>etc</span><span class=o>/</span><span class=n>prometheus</span><span class=o>/</span><span class=n>mysqld_exporter</span><span class=o>/</span><span class=n>my</span><span class=o>.</span><span class=n>cnf</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=部署-redis-exporter>部署 Redis Exporter</h3><ol><li>下载 redis_exporter 文件，并且放置到各个文件夹下</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>wget https://github.com/oliver006/redis_exporter/releases/download/v1.58.0/redis_exporter-v1.58.0.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>tar -xvf redis_exporter-v1.58.0.linux-amd64.tar.gz
</span></span><span class=line><span class=cl><span class=nb>cd</span> redis_exporter-v1.58.0.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>sudo cp redis_exporter /usr/local/bin
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>创建 redis_exporter 服务</li></ol><p>新建文件<code>/etc/systemd/system/redis_exporter.service</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>Unit</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>Description</span><span class=p>=</span><span class=nx>Redis</span> <span class=nx>Exporter</span>
</span></span><span class=line><span class=cl><span class=nx>Wants</span><span class=p>=</span><span class=nx>network-online</span><span class=p>.</span><span class=nx>target</span>
</span></span><span class=line><span class=cl><span class=nx>After</span><span class=p>=</span><span class=nx>network-online</span><span class=p>.</span><span class=nx>target</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Service</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>User</span><span class=p>=</span><span class=nx>root</span>
</span></span><span class=line><span class=cl><span class=nx>Group</span><span class=p>=</span><span class=nx>root</span>
</span></span><span class=line><span class=cl><span class=nx>Type</span><span class=p>=</span><span class=nx>simple</span>
</span></span><span class=line><span class=cl><span class=nx>Restart</span><span class=p>=</span><span class=nx>always</span>
</span></span><span class=line><span class=cl><span class=nx>ExecStart</span><span class=p>=</span><span class=err>/</span><span class=nx>usr</span><span class=err>/</span><span class=nx>local</span><span class=err>/</span><span class=nx>bin</span><span class=err>/</span><span class=nx>redis_exporter</span> <span class=err>\</span>
</span></span><span class=line><span class=cl>    <span class=nx>--redis</span><span class=p>.</span><span class=nx>password</span><span class=p>=</span><span class=nx>your_redis_password</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Install</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>WantedBy</span><span class=p>=</span><span class=nx>multi-user</span><span class=p>.</span><span class=nx>target</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>启动服务</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>sudo systemctl start redis_exporter
</span></span><span class=line><span class=cl>sudo systemctl status redis_exporter
</span></span></code></pre></td></tr></table></div></div><p>出现下列 <code>active</code> 信息即可，<code>redis_exporter</code> 服务运行在<code>:9121</code>端口</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>●</span> <span class=n>redis_exporter</span><span class=o>.</span><span class=n>service</span> <span class=o>-</span> <span class=n>Redis</span> <span class=n>Exporter</span>
</span></span><span class=line><span class=cl>     <span class=n>Loaded</span><span class=p>:</span> <span class=n>loaded</span> <span class=p>(</span><span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>system</span><span class=o>/</span><span class=n>redis_exporter</span><span class=o>.</span><span class=n>service</span><span class=p>;</span> <span class=n>disabled</span><span class=p>;</span> <span class=n>vendor</span> <span class=n>preset</span><span class=p>:</span> <span class=n>enabled</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>Active</span><span class=p>:</span> <span class=n>active</span> <span class=p>(</span><span class=n>running</span><span class=p>)</span> <span class=n>since</span> <span class=n>Sun</span> <span class=mi>2024</span><span class=o>-</span><span class=mi>04</span><span class=o>-</span><span class=mi>14</span> <span class=mi>20</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>14</span> <span class=n>CST</span><span class=p>;</span> <span class=mi>4</span> <span class=n>days</span> <span class=n>ago</span>
</span></span><span class=line><span class=cl>   <span class=n>Main</span> <span class=n>PID</span><span class=p>:</span> <span class=mi>3217820</span> <span class=p>(</span><span class=n>redis_exporter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>Tasks</span><span class=p>:</span> <span class=mi>9</span> <span class=p>(</span><span class=n>limit</span><span class=p>:</span> <span class=mi>2247</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>Memory</span><span class=p>:</span> <span class=mf>13.6</span><span class=n>M</span>
</span></span><span class=line><span class=cl>     <span class=n>CGroup</span><span class=p>:</span> <span class=o>/</span><span class=n>system</span><span class=o>.</span><span class=n>slice</span><span class=o>/</span><span class=n>redis_exporter</span><span class=o>.</span><span class=n>service</span>
</span></span><span class=line><span class=cl>             <span class=err>└─</span><span class=mi>3217820</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>redis_exporter</span> <span class=o>--</span><span class=n>redis</span><span class=o>.</span><span class=n>password</span><span class=o>=</span><span class=n>your_redis_password</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=部署-grafana>部署 Grafana</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo apt-get install -y adduser libfontconfig1 musl
</span></span><span class=line><span class=cl>wget https://dl.grafana.com/enterprise/release/grafana-enterprise_10.4.2_amd64.deb
</span></span><span class=line><span class=cl>sudo dpkg -i grafana-enterprise_10.4.2_amd64.deb
</span></span><span class=line><span class=cl>sudo systemctl status grafana-server.service
</span></span></code></pre></td></tr></table></div></div><p>检测服务，服务运行在 <code>:3000</code> 端口：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>●</span> <span class=n>grafana</span><span class=o>-</span><span class=n>server</span><span class=o>.</span><span class=n>service</span> <span class=o>-</span> <span class=n>Grafana</span> <span class=n>instance</span>
</span></span><span class=line><span class=cl>     <span class=n>Loaded</span><span class=p>:</span> <span class=n>loaded</span> <span class=p>(</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>system</span><span class=o>/</span><span class=n>grafana</span><span class=o>-</span><span class=n>server</span><span class=o>.</span><span class=n>service</span><span class=p>;</span> <span class=n>enabled</span><span class=p>;</span> <span class=n>vendor</span> <span class=n>preset</span><span class=p>:</span> <span class=n>enabled</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>Active</span><span class=p>:</span> <span class=n>active</span> <span class=p>(</span><span class=n>running</span><span class=p>)</span> <span class=n>since</span> <span class=n>Mon</span> <span class=mi>2024</span><span class=o>-</span><span class=mi>04</span><span class=o>-</span><span class=mi>15</span> <span class=mi>00</span><span class=p>:</span><span class=mi>38</span><span class=p>:</span><span class=mi>00</span> <span class=n>CST</span><span class=p>;</span> <span class=mi>4</span> <span class=n>days</span> <span class=n>ago</span>
</span></span><span class=line><span class=cl>       <span class=n>Docs</span><span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>docs</span><span class=o>.</span><span class=n>grafana</span><span class=o>.</span><span class=n>org</span>
</span></span><span class=line><span class=cl>   <span class=n>Main</span> <span class=n>PID</span><span class=p>:</span> <span class=mi>3286698</span> <span class=p>(</span><span class=n>grafana</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>Tasks</span><span class=p>:</span> <span class=mi>19</span> <span class=p>(</span><span class=n>limit</span><span class=p>:</span> <span class=mi>2247</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=n>Memory</span><span class=p>:</span> <span class=mf>109.8</span><span class=n>M</span>
</span></span><span class=line><span class=cl>     <span class=n>CGroup</span><span class=p>:</span> <span class=o>/</span><span class=n>system</span><span class=o>.</span><span class=n>slice</span><span class=o>/</span><span class=n>grafana</span><span class=o>-</span><span class=n>server</span><span class=o>.</span><span class=n>service</span>
</span></span><span class=line><span class=cl>             <span class=err>└─</span><span class=mi>3286698</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>grafana</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>grafana</span> <span class=n>server</span> <span class=o>--</span><span class=n>config</span><span class=o>=/</span><span class=n>etc</span><span class=o>/</span><span class=n>grafana</span><span class=o>/</span><span class=n>grafana</span><span class=o>.</span><span class=n>ini</span> <span class=o>--</span><span class=n>pidfile</span><span class=o>=/</span><span class=n>run</span><span class=o>/</span><span class=n>grafana</span><span class=o>/</span><span class=n>g</span><span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=遇到的问题>遇到的问题</h2><h3 id=图片上传前后端交互>图片上传前后端交互</h3><h4 id=前端代码>前端代码</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=nx>async</span> <span class=kd>function</span> <span class=nx>submitForm</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>value</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>formValue</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>imgList</span><span class=p>,</span> <span class=nx>version</span><span class=p>,</span> <span class=nx>promptId</span><span class=p>,</span> <span class=nx>style</span><span class=p>,</span> <span class=nx>gender</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>value</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>formData</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>FormData</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>imgList</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(({</span> <span class=nx>file</span> <span class=p>})</span> <span class=p>=&gt;</span> <span class=nx>formData</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=s1>&#39;images&#39;</span><span class=p>,</span> <span class=nx>file</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>{</span> <span class=nx>data</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>api</span><span class=p>.</span><span class=nx>generatePhoto</span><span class=p>(</span><span class=nx>formData</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=后端代码>后端代码</h4><p>处理图片上传：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>fileDir</span> <span class=o>:=</span> <span class=nx>path</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=s>&#34;tmp&#34;</span><span class=p>,</span> <span class=s>&#34;image&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Stat</span><span class=p>(</span><span class=nx>fileDir</span><span class=p>);</span> <span class=nx>os</span><span class=p>.</span><span class=nf>IsNotExist</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>_</span> <span class=p>=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>MkdirAll</span><span class=p>(</span><span class=nx>fileDir</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>ModePerm</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>fileHeader</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>r</span><span class=p>.</span><span class=nx>MultipartForm</span><span class=p>.</span><span class=nx>File</span><span class=p>[</span><span class=s>&#34;images&#34;</span><span class=p>]</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>file</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>fileHeader</span><span class=p>.</span><span class=nf>Open</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>filename</span> <span class=o>:=</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%d%s&#34;</span><span class=p>,</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>UnixMicro</span><span class=p>(),</span> <span class=nx>path</span><span class=p>.</span><span class=nf>Ext</span><span class=p>(</span><span class=nx>fileHeader</span><span class=p>.</span><span class=nx>Filename</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=nx>filePath</span> <span class=o>:=</span> <span class=nx>path</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=nx>fileDir</span><span class=p>,</span> <span class=nx>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>dst</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=nx>filePath</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>_</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>io</span><span class=p>.</span><span class=nf>Copy</span><span class=p>(</span><span class=nx>dst</span><span class=p>,</span> <span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>req</span><span class=p>.</span><span class=nx>Images</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>Images</span><span class=p>,</span> <span class=nx>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>_</span> <span class=p>=</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>_</span> <span class=p>=</span> <span class=nx>dst</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// 异步删除
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>go</span> <span class=kd>func</span><span class=p>(</span><span class=nx>images</span> <span class=p>[]</span><span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>item</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>images</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Remove</span><span class=p>(</span><span class=nx>path</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=nx>fileDir</span><span class=p>,</span> <span class=nx>item</span><span class=p>));</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>logx</span><span class=p>.</span><span class=nf>Error</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}(</span><span class=nx>req</span><span class=p>.</span><span class=nx>Images</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>文件（图片）服务器</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>GetFileHandler</span><span class=p>(</span><span class=nx>svcCtx</span> <span class=o>*</span><span class=nx>svc</span><span class=p>.</span><span class=nx>ServiceContext</span><span class=p>)</span> <span class=nx>http</span><span class=p>.</span><span class=nx>HandlerFunc</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kd>func</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>req</span> <span class=nx>types</span><span class=p>.</span><span class=nx>GetFileReq</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>httpx</span><span class=p>.</span><span class=nf>Parse</span><span class=p>(</span><span class=nx>r</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>req</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>httpresp</span><span class=p>.</span><span class=nf>HttpError</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>BadRequest</span><span class=p>(</span><span class=nx>errors</span><span class=p>.</span><span class=nx>DefaultBadRequestID</span><span class=p>,</span> <span class=nx>err</span><span class=p>.</span><span class=nf>Error</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>filename</span> <span class=o>:=</span> <span class=nx>path</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=s>&#34;tmp&#34;</span><span class=p>,</span> <span class=nx>req</span><span class=p>.</span><span class=nx>Dir</span><span class=p>,</span> <span class=nx>req</span><span class=p>.</span><span class=nx>Filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Stat</span><span class=p>(</span><span class=nx>filename</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=nx>os</span><span class=p>.</span><span class=nf>IsNotExist</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>_</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>w</span><span class=p>.</span><span class=nf>Write</span><span class=p>([]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;file not exist&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=nx>httpx</span><span class=p>.</span><span class=nf>Ok</span><span class=p>(</span><span class=nx>w</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>httpresp</span><span class=p>.</span><span class=nf>HttpError</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>NotFound</span><span class=p>(</span><span class=nx>errors</span><span class=p>.</span><span class=nx>DefaultNotFoundID</span><span class=p>,</span> <span class=nx>err</span><span class=p>.</span><span class=nf>Error</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>http</span><span class=p>.</span><span class=nf>ServeFile</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=nx>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=数据库软删除与唯一索引冲突>数据库软删除与唯一索引冲突</h3><p>暂无解决方案</p><h3 id=前端-json-展示>前端 json 展示</h3><p>使用 vue-json-viewer 包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>n-form</span>
</span></span><span class=line><span class=cl>    <span class=na>ref</span><span class=o>=</span><span class=s>&#34;modalFormRef&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>label</span><span class=nt>-placement</span><span class=err>=&#34;</span><span class=na>top</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>label</span><span class=nt>-align</span><span class=err>=&#34;</span><span class=na>left</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nt>:model</span><span class=o>=</span><span class=s>&#34;modalForm&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>n-form-item</span> <span class=na>label</span><span class=o>=</span><span class=s>&#34;请求头&#34;</span> <span class=na>path</span><span class=o>=</span><span class=s>&#34;reqHeader&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>JsonViewer</span>
</span></span><span class=line><span class=cl>        <span class=nt>:value</span><span class=o>=</span><span class=s>&#34;JSON.parse(modalForm.reqHeader)&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>copyable</span>
</span></span><span class=line><span class=cl>        <span class=na>sort</span>
</span></span><span class=line><span class=cl>        <span class=na>boxed</span>
</span></span><span class=line><span class=cl>        <span class=na>expanded</span>
</span></span><span class=line><span class=cl>        <span class=o>:</span><span class=na>theme</span><span class=o>=</span><span class=s>&#34;appStore.isDark ? &#39;jv-dark&#39; : &#39;jv-light&#39;&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=c>&lt;!--</span> <span class=p>&lt;</span><span class=nt>n-input</span> <span class=na>v</span><span class=nt>-model:value</span><span class=o>=</span><span class=s>&#34;modalForm.reqHeader&#34;</span> <span class=p>/&gt;</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>n-form-item</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>n-form-item</span> <span class=na>label</span><span class=o>=</span><span class=s>&#34;请求体&#34;</span> <span class=na>path</span><span class=o>=</span><span class=s>&#34;reqBody&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>JsonViewer</span>
</span></span><span class=line><span class=cl>        <span class=nt>:value</span><span class=o>=</span><span class=s>&#34;JSON.parse(modalForm.reqBody)&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>copyable</span>
</span></span><span class=line><span class=cl>        <span class=na>boxed</span>
</span></span><span class=line><span class=cl>        <span class=na>sort</span>
</span></span><span class=line><span class=cl>        <span class=o>:</span><span class=na>theme</span><span class=o>=</span><span class=s>&#34;appStore.isDark ? &#39;jv-dark&#39; : &#39;jv-light&#39;&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=c>&lt;!--</span> <span class=p>&lt;</span><span class=nt>n-input</span> <span class=na>v</span><span class=nt>-model:value</span><span class=o>=</span><span class=s>&#34;modalForm.reqBody&#34;</span> <span class=p>/&gt;</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>n-form-item</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>n-form-item</span> <span class=na>label</span><span class=o>=</span><span class=s>&#34;返回结果&#34;</span> <span class=na>path</span><span class=o>=</span><span class=s>&#34;response&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>JsonViewer</span>
</span></span><span class=line><span class=cl>        <span class=nt>:value</span><span class=o>=</span><span class=s>&#34;JSON.parse(modalForm.response)&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>copyable</span>
</span></span><span class=line><span class=cl>        <span class=na>boxed</span>
</span></span><span class=line><span class=cl>        <span class=na>sort</span>
</span></span><span class=line><span class=cl>        <span class=na>expanded</span>
</span></span><span class=line><span class=cl>        <span class=o>:</span><span class=na>theme</span><span class=o>=</span><span class=s>&#34;appStore.isDark ? &#39;jv-dark&#39; : &#39;jv-light&#39;&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=c>&lt;!--</span> <span class=p>&lt;</span><span class=nt>n-input</span> <span class=na>v</span><span class=nt>-model:value</span><span class=o>=</span><span class=s>&#34;modalForm.response&#34;</span> <span class=p>/&gt;</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>n-form-item</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>n-form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>JsonViewer</span> <span class=nx>from</span> <span class=s2>&#34;vue-json-viewer&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s2>&#34;vue-json-viewer/style.css&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s2>&#34;vue3-json-viewer/dist/index.css&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2025-01-26&nbsp;<a class=git-hash href=https://github.com/pjimming/blog/commit/de5fce5616fea8d08ae0462fbeaef539917874fe target=_blank title="commit by panjiangming(panjiangming@kuaishou.com) de5fce5616fea8d08ae0462fbeaef539917874fe: replace cdn: jsdelivr -> cloudfare">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>de5fce5</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/2024-04-05/graduation-design/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://blog.pjmcode.top/2024-04-05/graduation-design/ data-title="【毕业季】本科毕设《Magic Camera》需求清单" data-hashtags=blog,毕业设计><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://blog.pjmcode.top/2024-04-05/graduation-design/ data-hashtag=blog><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://blog.pjmcode.top/2024-04-05/graduation-design/ data-title="【毕业季】本科毕设《Magic Camera》需求清单"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://blog.pjmcode.top/2024-04-05/graduation-design/ data-title="【毕业季】本科毕设《Magic Camera》需求清单"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://blog.pjmcode.top/2024-04-05/graduation-design/ data-title="【毕业季】本科毕设《Magic Camera》需求清单" data-image=https://picx-img.pjmcode.top/20240405/image-image.1lbllk4u06.webp><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/blog/>Blog</a>,&nbsp;<a href=/tags/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/>毕业设计</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2024-04-01/qiniu/ class=prev rel=prev title=【纪念向】我在杭州七牛云的323天><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>【纪念向】我在杭州七牛云的323天</a>
<a href=/2024-05-04/mysql45-1/ class=next rel=next title=《MySQL实战45讲》阅读笔记——基础篇>《MySQL实战45讲》阅读笔记——基础篇<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app>Giscus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><span id=run-time></span></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2024 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=备案编号" target=_blank>浙ICP备2024074882号</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:-1},comment:{giscus:{category:"Announcements",categoryId:"DIC_kwDOLZmgDc4Cdm7x",darkTheme:"preferred_color_scheme",emitMetadata:"0",inputPosition:"top",lang:"zh-CN",lazyLoading:!1,lightTheme:"light",mapping:"pathname",reactionsEnabled:"1",repo:"pjimming/blog-comment",repoId:"R_kgDOLZmgDQ"}},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=https://cdn.staticfile.net/jquery/2.2.4/jquery.min.js></script><script type=text/javascript src=/js/custom.js></script></body></html>